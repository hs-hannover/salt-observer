$(function(){function e(e){var t=JSON.parse(e.data.substring(6));return"data"in t.data?(t.title=t.data.data.title,t.message=t.data.data.message.substring(0,300)+"[...]",t.severity=i[t.data.data.severity]):(t.title=t.data.id,t.message="<pre>"+JSON.stringify(t)+"</pre>",t.severity=i[0]),t}function t(e){var t=$("#event-template").clone();t.removeAttr("id"),t.addClass("severity-"+e.severity.name),t.find(".icon").html('<i class="fa fa-fw fa-2x fa-'+e.severity.icon+'"></i>'),t.find(".title").text(e.title),t.find(".message").html(e.message),t.find(".tag").text(e.tag),t.find(".minion-id").text(e.data.id),t.find(".timestamp").text(Date(e.data._stamp)),$("#eventholder").prepend(t),setTimeout(function(){t.remove()},3e5)}function a(e){var t=$("#job-template").clone();t.removeAttr("id"),t.find(".timestamp").text(e.data._stamp),t.find(".tag").text(e.tag),$("#jobholder").prepend(t),setTimeout(function(){t.remove()},6e4)}var n=new WebSocket("wss://"+host+":"+port+"/all_events/"+token);n.onopen=function(){n.send("websocket client ready"),console.log("Connected!"),$("#conn_status").html('<i class="fa fa-fw fa-check"></i> Connected!')},n.onerror=function(e){console.debug("Error!",e),$("#conn_status").html('<i class="fa fa-fw fa-times"></i> Connection failed!')},n.onmessage=function(n){var n=e(n);n.tag.startsWith("salt/job/")?a(n):t(n)};var i={0:{name:"debug",icon:"bug"},10:{name:"info",icon:"info"},20:{name:"success",icon:"check"},30:{name:"warning",icon:"exclamation-triangle"},40:{name:"critical",icon:"times"}}});